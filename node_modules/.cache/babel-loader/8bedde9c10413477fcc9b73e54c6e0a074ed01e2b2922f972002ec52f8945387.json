{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/zixuanchen/zixuan/my-website/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5;import React,{useState,useEffect}from'react';import styled from'styled-components';import{useLocation}from'react-router-dom';import ReactMarkdown from'react-markdown';// 引入react-markdown库\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    padding: 80px 20px;\\n    text-align: center;\\n    background: linear-gradient(135deg, #c3b6d8 0%, #e2dfe2 100%);\\n    min-height: 100vh;\\n\"])));const ChatBox=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    width: 90%;\\n    max-width: 800px;\\n    margin: 20px auto;\\n    background-color: white;\\n    border-radius: 25px;\\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\\n    padding: 30px;\\n    text-align: left;\\n\"])));const Message=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    margin: 10px 0;\\n    padding: 10px;\\n    background-color: #f5f5f5;\\n    border-radius: 15px;\\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n\"])));const Input=styled.input(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n    width: calc(100% - 24px);\\n    padding: 15px;\\n    margin: 10px 0;\\n    border: 1px solid #ccc;\\n    border-radius: 25px;\\n    font-size: 1.1em;\\n\"])));const Button=styled.button(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n    padding: 10px 20px;\\n    background-color: #a992d4;\\n    color: white;\\n    border: none;\\n    border-radius: 25px;\\n    cursor: pointer;\\n    font-size: 1em;\\n    margin-top: 10px;\\n\"])));const TypingEffect=_ref=>{let{message}=_ref;const[displayedText,setDisplayedText]=useState('');useEffect(()=>{let index=0;const interval=setInterval(()=>{setDisplayedText(prev=>prev+message[index]);index++;if(index===message.length){clearInterval(interval);}},17);// 设置打字动画的速度\nreturn()=>clearInterval(interval);},[message]);return/*#__PURE__*/_jsx(\"span\",{children:displayedText});};// 渲染Markdown文本，带有逐字动画效果\nconst MarkdownTypingEffect=_ref2=>{let{content}=_ref2;const[displayedText,setDisplayedText]=useState('');useEffect(()=>{let index=0;const interval=setInterval(()=>{setDisplayedText(prev=>prev+content[index]);index++;if(index===content.length){clearInterval(interval);}},17);return()=>clearInterval(interval);},[content]);return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(ReactMarkdown,{children:displayedText})});};const ChatAI=()=>{var _location$state;const location=useLocation();const[messages,setMessages]=useState([]);const[input,setInput]=useState('');const query=((_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.query)||'';// 获取从About.js传递来的初始问题\nuseEffect(()=>{if(query){const userMessage={role:'user',content:query};// 调用 OpenAI API 回答初始问题\nhandleApiRequest([userMessage]);}},[query]);const handleInputChange=e=>{setInput(e.target.value);};const handleFormSubmit=async e=>{e.preventDefault();if(input.trim()){const userMessage={role:'user',content:input};// 添加用户消息到对话记录中\nsetMessages(prevMessages=>[...prevMessages,userMessage]);// 调用 OpenAI API 并传递整个对话记录\nhandleApiRequest([...messages,userMessage]);setInput('');// 清空输入框\n}};const handleApiRequest=async currentMessages=>{try{const res=await fetch('https://zixuan-web-e7b7250fbb7c.herokuapp.com/api/ask',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({messages:currentMessages,max_tokens:4096})});if(!res.ok){throw new Error(\"HTTP error! status: \".concat(res.status));}const data=await res.json();const assistantMessage={role:'assistant',content:data.response};// 添加 AI 的消息到对话记录中\nsetMessages(prevMessages=>[...prevMessages,assistantMessage]);}catch(error){console.error('Fetch error:',error.message);}};return/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(ChatBox,{children:[messages.map((msg,index)=>/*#__PURE__*/_jsxs(Message,{children:[/*#__PURE__*/_jsx(\"strong\",{children:msg.role==='user'?'You: ':'AI: '}),msg.role==='assistant'?/*#__PURE__*/_jsx(MarkdownTypingEffect,{content:msg.content}):msg.content]},index)),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleFormSubmit,children:[/*#__PURE__*/_jsx(Input,{type:\"text\",value:input,onChange:handleInputChange,placeholder:\"Type your question here...\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"Send\"})]})]})});};export default ChatAI;","map":{"version":3,"names":["React","useState","useEffect","styled","useLocation","ReactMarkdown","jsx","_jsx","jsxs","_jsxs","Container","div","_templateObject","_taggedTemplateLiteral","ChatBox","_templateObject2","Message","_templateObject3","Input","input","_templateObject4","Button","button","_templateObject5","TypingEffect","_ref","message","displayedText","setDisplayedText","index","interval","setInterval","prev","length","clearInterval","children","MarkdownTypingEffect","_ref2","content","ChatAI","_location$state","location","messages","setMessages","setInput","query","state","userMessage","role","handleApiRequest","handleInputChange","e","target","value","handleFormSubmit","preventDefault","trim","prevMessages","currentMessages","res","fetch","method","headers","body","JSON","stringify","max_tokens","ok","Error","concat","status","data","json","assistantMessage","response","error","console","map","msg","onSubmit","type","onChange","placeholder"],"sources":["/Users/zixuanchen/zixuan/my-website/src/components/ChatAI.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { useLocation } from 'react-router-dom';\nimport ReactMarkdown from 'react-markdown';  // 引入react-markdown库\n\nconst Container = styled.div`\n    padding: 80px 20px;\n    text-align: center;\n    background: linear-gradient(135deg, #c3b6d8 0%, #e2dfe2 100%);\n    min-height: 100vh;\n`;\n\nconst ChatBox = styled.div`\n    width: 90%;\n    max-width: 800px;\n    margin: 20px auto;\n    background-color: white;\n    border-radius: 25px;\n    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);\n    padding: 30px;\n    text-align: left;\n`;\n\nconst Message = styled.div`\n    margin: 10px 0;\n    padding: 10px;\n    background-color: #f5f5f5;\n    border-radius: 15px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n`;\n\nconst Input = styled.input`\n    width: calc(100% - 24px);\n    padding: 15px;\n    margin: 10px 0;\n    border: 1px solid #ccc;\n    border-radius: 25px;\n    font-size: 1.1em;\n`;\n\nconst Button = styled.button`\n    padding: 10px 20px;\n    background-color: #a992d4;\n    color: white;\n    border: none;\n    border-radius: 25px;\n    cursor: pointer;\n    font-size: 1em;\n    margin-top: 10px;\n`;\n\nconst TypingEffect = ({ message }) => {\n    const [displayedText, setDisplayedText] = useState('');\n\n    useEffect(() => {\n        let index = 0;\n        const interval = setInterval(() => {\n            setDisplayedText((prev) => prev + message[index]);\n            index++;\n            if (index === message.length) {\n                clearInterval(interval);\n            }\n        }, 17); // 设置打字动画的速度\n\n        return () => clearInterval(interval);\n    }, [message]);\n\n    return <span>{displayedText}</span>;\n};\n\n// 渲染Markdown文本，带有逐字动画效果\nconst MarkdownTypingEffect = ({ content }) => {\n    const [displayedText, setDisplayedText] = useState('');\n\n    useEffect(() => {\n        let index = 0;\n        const interval = setInterval(() => {\n            setDisplayedText((prev) => prev + content[index]);\n            index++;\n            if (index === content.length) {\n                clearInterval(interval);\n            }\n        }, 17);\n\n        return () => clearInterval(interval);\n    }, [content]);\n\n    return (\n        <div>\n            <ReactMarkdown>{displayedText}</ReactMarkdown>\n        </div>\n    );\n};\n\nconst ChatAI = () => {\n    const location = useLocation();\n    const [messages, setMessages] = useState([]);\n    const [input, setInput] = useState('');\n    const query = location.state?.query || ''; // 获取从About.js传递来的初始问题\n\n    useEffect(() => {\n        if (query) {\n            const userMessage = { role: 'user', content: query };\n            // 调用 OpenAI API 回答初始问题\n            handleApiRequest([userMessage]);\n        }\n    }, [query]);\n\n    const handleInputChange = (e) => {\n        setInput(e.target.value);\n    };\n\n    const handleFormSubmit = async (e) => {\n        e.preventDefault();\n        if (input.trim()) {\n            const userMessage = { role: 'user', content: input };\n\n            // 添加用户消息到对话记录中\n            setMessages((prevMessages) => [...prevMessages, userMessage]);\n\n            // 调用 OpenAI API 并传递整个对话记录\n            handleApiRequest([...messages, userMessage]);\n            setInput(''); // 清空输入框\n        }\n    };\n\n    const handleApiRequest = async (currentMessages) => {\n        try {\n            const res = await fetch('https://zixuan-web-e7b7250fbb7c.herokuapp.com/api/ask', {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ \n                messages: currentMessages,\n                max_tokens: 4096, }), \n            });\n\n            if (!res.ok) {\n                throw new Error(`HTTP error! status: ${res.status}`);\n            }\n\n            const data = await res.json();\n            const assistantMessage = { role: 'assistant', content: data.response };\n\n            // 添加 AI 的消息到对话记录中\n            setMessages((prevMessages) => [...prevMessages, assistantMessage]);\n        } catch (error) {\n            console.error('Fetch error:', error.message);\n        }\n    };\n\n    return (\n        <Container>\n            <ChatBox>\n                {messages.map((msg, index) => (\n                    <Message key={index}>\n                        <strong>{msg.role === 'user' ? 'You: ' : 'AI: '}</strong>\n                        {msg.role === 'assistant' ? (\n                            <MarkdownTypingEffect content={msg.content} />\n                        ) : (\n                            msg.content\n                        )}\n                    </Message>\n                ))}\n                <form onSubmit={handleFormSubmit}>\n                    <Input\n                        type=\"text\"\n                        value={input}\n                        onChange={handleInputChange}\n                        placeholder=\"Type your question here...\"\n                    />\n                    <Button type=\"submit\">Send</Button>\n                </form>\n            </ChatBox>\n        </Container>\n    );\n};\n\nexport default ChatAI;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}